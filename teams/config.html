<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello world!</title>

    <style>
      body {
        margin: 1em;
        font-family: 'Segoe UI', 'Roboto', 'Droid Sans','Helvetica Neue', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      a {
        color: #6264A7;
      }
    </style>
    
    <!-- Teams JS SDK -->
    <script src="https://statics.teams.cdn.office.net/sdk/v1.6.0/js/MicrosoftTeams.min.js"></script>

  </head>  
  <body>
    <h1>Hello world, <span id="user"></span>!</h1>
    
    <div>
      <img src="http://placeimg.com/400/210/tech" alt="a random tech image" width="400" height="210">
    </div>
    
    <p>  
      Click <strong>Save</strong> to add this tab content to your workspace!
    </p>
    
    <script>
    microsoftTeams.initialize();
    
    microsoftTeams.settings.setSettings({
      contentUrl: 'https://msteams-teamtab-minimum.glitch.me/index.html',
    });
    microsoftTeams.settings.setValidityState(true); 
    
    // Handling the theme color detection and change
      
    microsoftTeams.getContext((context) => {
      document.getElementById('user').textContent = context.loginHint;
      
      if(context.theme !== 'default') {
        document.body.style.color = '#fff';
      }
    });
    
    microsoftTeams.registerOnThemeChangeHandler((theme)=> { 
      if(theme !== 'default') {
        document.body.style.color = '#fff';
      } else {
        document.body.style.color = 'inherit';
      }
    });
    
    </script>

  </body>
</html>